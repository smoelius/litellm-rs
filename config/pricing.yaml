# Pricing Configuration
# This file only contains pricing-related settings and fallbacks
# Detailed pricing data is managed in the database

# Global pricing settings
pricing:
  # Default currency for all providers
  default_currency: "USD"
  
  # Pricing data source priority (in order)
  source_priority:
    - cache      # Memory and Redis cache (fastest)
    - config     # Database storage (persistent)
    - external_api  # External pricing APIs
    - provider_api  # Provider's own APIs
  
  # Enable pricing cache
  enable_cache: true
  
  # Auto-update pricing from external sources
  auto_update: false
  
  # Update interval in seconds (24 hours)
  update_interval: 86400
  
  # Global fallback pricing (when no other source is available)
  fallback_pricing:
    model: "unknown"
    input_cost_per_1k: 0.01
    output_cost_per_1k: 0.01
    currency: "USD"
    notes: "Global fallback pricing"

# Provider-specific pricing configurations
providers:
  # OpenAI pricing configuration
  openai:
    # Default pricing for unknown OpenAI models
    default_pricing:
      input_cost_per_1k: 0.01
      output_cost_per_1k: 0.03
      currency: "USD"
      notes: "OpenAI default pricing"
    
    # External pricing API (optional)
    use_external_api: false
    # external_api_url: "https://api.openai-pricing.com"
    
    # Cache TTL in seconds (1 hour)
    cache_ttl: 3600

  # Anthropic pricing configuration  
  anthropic:
    default_pricing:
      input_cost_per_1k: 0.008
      output_cost_per_1k: 0.024
      currency: "USD"
      notes: "Anthropic default pricing (similar to Claude 2)"
    
    use_external_api: false
    cache_ttl: 3600

  # GLM (Zhipu AI) pricing configuration
  glm:
    default_pricing:
      input_cost_per_1k: 0.0001   # Very cost-effective
      output_cost_per_1k: 0.0003
      currency: "USD"
      notes: "GLM default pricing (converted from RMB)"
    
    use_external_api: false
    cache_ttl: 3600

  # Google AI pricing configuration
  google:
    default_pricing:
      input_cost_per_1k: 0.0005
      output_cost_per_1k: 0.001
      currency: "USD"
      notes: "Google AI default pricing"
    
    use_external_api: false
    cache_ttl: 3600

  # Groq pricing configuration (free tier)
  groq:
    default_pricing:
      input_cost_per_1k: 0.0
      output_cost_per_1k: 0.0
      currency: "USD"
      notes: "Groq free tier pricing"
    
    use_external_api: false
    cache_ttl: 7200  # Longer cache since it's free

  # Cohere pricing configuration
  cohere:
    default_pricing:
      input_cost_per_1k: 0.015
      output_cost_per_1k: 0.015
      currency: "USD"
      notes: "Cohere default pricing"
    
    use_external_api: false
    cache_ttl: 3600

# Database configuration for pricing storage
database:
  # Connection URL for pricing database
  url: "${DATABASE_URL}"
  
  # Connection pool settings
  max_connections: 10
  min_connections: 2
  
  # Migration settings
  auto_migrate: true

# Redis cache configuration (optional but recommended)
redis:
  # Redis URL for pricing cache
  url: "${REDIS_URL:-redis://localhost:6379}"
  
  # Default TTL for pricing cache entries (1 hour)
  default_ttl: 3600
  
  # Key prefix for pricing cache
  key_prefix: "pricing:"

# External pricing API configuration
external_apis:
  # Global timeout for external API calls
  timeout: 10
  
  # Retry configuration
  max_retries: 3
  retry_delay: 1000  # milliseconds
  
  # Rate limiting
  rate_limit:
    requests_per_second: 10
    burst_size: 20

# Pricing update notifications
notifications:
  # Enable pricing update webhooks
  enable_webhooks: false
  
  # Webhook endpoints for pricing updates
  webhooks:
    - url: "${PRICING_WEBHOOK_URL}"
      secret: "${PRICING_WEBHOOK_SECRET}"
      events:
        - pricing_updated
        - pricing_added
        - pricing_expired

# Monitoring and alerts
monitoring:
  # Enable pricing monitoring
  enabled: true
  
  # Alert thresholds
  alerts:
    # Alert when fallback pricing is used more than X% of requests
    fallback_usage_threshold: 10.0
    
    # Alert when cache hit rate is below X%
    cache_hit_rate_threshold: 85.0
    
    # Alert when pricing data is stale (hours)
    stale_data_threshold: 24

# Advanced settings
advanced:
  # Enable pricing analytics
  enable_analytics: true
  
  # Store pricing history
  store_history: true
  
  # Batch update settings
  batch_update:
    enabled: false
    batch_size: 100
    interval: 3600  # seconds
    
  # Pricing validation
  validation:
    # Minimum cost per 1K tokens (to catch errors)
    min_cost_per_1k: 0.0
    # Maximum cost per 1K tokens (to catch errors)  
    max_cost_per_1k: 1.0
    
    # Require currency field
    require_currency: true
    
    # Allowed currencies
    allowed_currencies: ["USD", "EUR", "CNY", "JPY"]